<h1>{{title}}</h1>
{{#with post}}
<h2 class="text-xl"> {{title}} </h2> 
<div>
    작성자 : <b>{{writer}}</b>
</div>
<div>
    조회수 : {{hits}} || 작성일시: {{dateString createddt}}
    <button onclick="modifyPost()">Modity</button> <!--게시글 관련 버튼 영역-->
    <button onclick="deletePost()">Delete</button>
</div>

<div>
    <pre>{{content}}</pre> <!--본문 표시 영역-->
</div>

<section>
    <div>
        <h3>new 3 comment</h3> <!-- 댓글 개수 표시 -->
    </div>
    <form method="post" action = "/write-comment"> <!--댓글 작성 폼-->
        <div>
            <div>
                <input type = "text" name = "name" placeholder = "Name"/>
                <input type = "password" name = "password" placeholder = "password"/>
            </div>
            <div> <!--댓글 전송 버튼-->
                <textarea cols = "40" rows = "3" name = "comment" placeholder = "write comment here"></textarea>
                <br/><br/><button> Send </button>
            </div>
        </div>
    </form>
    <section> <!--댓글 표시 영역-->
        <div>
            <div>
                작성자 : <b> 댓글 작성자</b>
            </div>
            <div>
                작성일시 : 2023-05-19 11:24:57
                <button onclick="deleteComment('1')"> Commant Delete</button>
            </div>
        </div>
        <div>
            <pre>{{comment}}</pre> <!--고정폭 글꼴 사용-->
        </div>
    </section>
    <footer>
        <div>
            <a href="/">목록으로</a>
        </div>
    </footer>
</section>
{{/with}}
<script>
    const postOption = {
        method: "POST",
        headers:{
            'Content-Type':'application/json',
        },
    }
    async function modifyPost() { 
        const password = prompt("패스워드를 입력하세요.");
        if(!password){
            return;
        }
        const result = await fetch("/check-password",{
        ...postOption,
        body: JSON.stringify({id: "{{post._id}}",password})
        });
        const data = await result.json();
        if(data.isExist){
            document.location = "/modify/{{post._id}}"
        }else{
            alert("패스워드를 확인해주세요.");
        }
    }
    
    async function deletePost() { }
</script>